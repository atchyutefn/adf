{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "aarADF"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/3 Coveo_CNT_partilal_PUSH_3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Until_Stream1",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream1')), int(variables('Stream1_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1').output.FirstRow.Js1,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js1 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream1'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream1 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream1_Log",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1_Temp",
										"value": {
											"value": "@variables('Stream1')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Push 1",
											"dependencyConditions": [
												"Completed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1",
										"value": {
											"value": "@{add(int(variables('Stream1_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream1_Log",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": {
											"value": "@pipeline().parameters.StoredProcedureName",
											"type": "Expression"
										},
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream1'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@{activity('Coveo Stream Chunk Push 1').Error?.message}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream2",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream2')), int(variables('Stream2_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 2",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 2",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 2",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 2').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 2').output.FirstRow.Js2,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 2",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js2 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream2'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream2 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream2_Log",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2_Temp",
										"value": {
											"value": "@variables('Stream2')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream2 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream2 var",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Push 2",
											"dependencyConditions": [
												"Completed",
												"Skipped"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2",
										"value": {
											"value": "@{add(int(variables('Stream2_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream2_Log",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 2",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": {
											"value": "@pipeline().parameters.StoredProcedureName",
											"type": "Expression"
										},
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 2').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 2').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream2'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@{activity('Coveo Stream Chunk Push 2').Error?.message}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 2",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 2",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 2",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 2').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream3",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream3_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream3')), int(variables('Stream3_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 3",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 3').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 3').output.FirstRow.Js3,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 3",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js3 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream3'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream3 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3_Temp",
										"value": {
											"value": "@variables('Stream3')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream3 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream3 var",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Push 3",
											"dependencyConditions": [
												"Completed",
												"Skipped"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3",
										"value": {
											"value": "@{add(int(variables('Stream3_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream3",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": {
											"value": "@pipeline().parameters.StoredProcedureName",
											"type": "Expression"
										},
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream3'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@{activity('Coveo Stream Chunk Push 3').Error?.message}",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 3",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 3').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Set Stream1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Temp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1",
							"value": {
								"value": "@{add(mul(6,int(variables('Temp'))),activity('Lookup_cnt').output.value[0].srt_value)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup_cnt",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set TableName",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT  *  FROM stg.cnt_loaddistributor where id = @{int(pipeline().parameters.id)}",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set Stream1_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream1')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Temp",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_cnt",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Temp",
							"value": {
								"value": "@{div(add(sub(activity('Lookup_cnt').output.value[0].end_value,activity('Lookup_cnt').output.value[0].srt_value),1),9)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2",
							"value": {
								"value": "@{add(int(variables('Stream1_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream2')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3",
							"value": {
								"value": "@{add(int(variables('Stream2_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3_End",
							"value": {
								"value": "@{activity('Lookup_cnt').output.value[0].end_value}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set TableName",
						"type": "SetVariable",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Table_name",
							"value": {
								"value": "@pipeline().parameters.Table_name",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					},
					"Table_name": {
						"type": "string"
					},
					"id": {
						"type": "string"
					},
					"StoredProcedureName": {
						"type": "string"
					}
				},
				"variables": {
					"Stream1": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_End": {
						"type": "String",
						"defaultValue": "100"
					},
					"Stream2": {
						"type": "String",
						"defaultValue": "101"
					},
					"Stream2_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream2_End": {
						"type": "String",
						"defaultValue": "200"
					},
					"Stream3": {
						"type": "String",
						"defaultValue": "201"
					},
					"Stream3_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream3_End": {
						"type": "String",
						"defaultValue": "300"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"Table_name": {
						"type": "String",
						"defaultValue": "stg.CoveoPushData_json_cnt_lookup3"
					},
					"Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Source": {
						"type": "String",
						"defaultValue": "xqzjpr66aahsdkjh6go4dycoca"
					},
					"id": {
						"type": "String",
						"defaultValue": "3"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Full Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/4 1 Delta_Partial_CNT_Push_1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Until_Stream1",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream1')), int(variables('Stream1_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1').output.FirstRow.Js1,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js1 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream1'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream1 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream1_Log",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1_Temp",
										"value": {
											"value": "@variables('Stream1')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1",
										"value": {
											"value": "@{add(int(variables('Stream1_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream1_Log",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream1'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 1').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream2",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream2')), int(variables('Stream2_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1_copy1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1_copy1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1_copy1').output.FirstRow.Js2,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1_copy1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js2 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream2'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream1 var_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream1_Log_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2_Temp",
										"value": {
											"value": "@variables('Stream2')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2",
										"value": {
											"value": "@{add(int(variables('Stream2_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream1_Log_copy1",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1_copy1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 1_copy1').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 1_copy1').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream2'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 1_copy1').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 1_copy1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1_copy1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1_copy1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream3",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream3_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream3')), int(variables('Stream3_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 3",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 3').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 3').output.FirstRow.Js3,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 3",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js3 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream3'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream3 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3_Temp",
										"value": {
											"value": "@variables('Stream3')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream3 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream3 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3",
										"value": {
											"value": "@{add(int(variables('Stream3_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream3",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream3'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 3').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 3",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 3').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Set Stream1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_cnt",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1",
							"value": {
								"value": "@{activity('Lookup_cnt').output.value[0].srt_value}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup_cnt",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT  *  FROM stg.cnt_loaddistributor_delta where id = @{int(variables('id'))}",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set Stream1_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Temp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream1')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Temp",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_cnt",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Temp",
							"value": {
								"value": "@{div(add(sub(activity('Lookup_cnt').output.value[0].end_value,activity('Lookup_cnt').output.value[0].srt_value),1),3)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2",
							"value": {
								"value": "@{add(int(variables('Stream1_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream2')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3",
							"value": {
								"value": "@{add(int(variables('Stream2_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3_End",
							"value": {
								"value": "@{activity('Lookup_cnt').output.value[0].end_value}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Wait1",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream1",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Wait2",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream2",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Wait3",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream3",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"variables": {
					"Stream1": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_End": {
						"type": "String",
						"defaultValue": "100"
					},
					"Stream2": {
						"type": "String",
						"defaultValue": "101"
					},
					"Stream2_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream2_End": {
						"type": "String",
						"defaultValue": "200"
					},
					"Stream3": {
						"type": "String",
						"defaultValue": "201"
					},
					"Stream3_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream3_End": {
						"type": "String",
						"defaultValue": "300"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"Table_name": {
						"type": "String",
						"defaultValue": "stg.CoveoPushData_json_cnt_lookup_delta"
					},
					"Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Source": {
						"type": "String",
						"defaultValue": "xqzjpr66aahsdkjh6go4dycoca"
					},
					"id": {
						"type": "String",
						"defaultValue": "1"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/4 2 Delta_Partial_CNT_Push_2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Until_Stream1",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream1')), int(variables('Stream1_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1').output.FirstRow.Js1,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js1 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream1'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream1 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream1_Log",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1_Temp",
										"value": {
											"value": "@variables('Stream1')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1",
										"value": {
											"value": "@{add(int(variables('Stream1_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream1_Log",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream1'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 1').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream2",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream2')), int(variables('Stream2_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1_copy1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1_copy1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1_copy1').output.FirstRow.Js2,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1_copy1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js2 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream2'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream1 var_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream1_Log_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2_Temp",
										"value": {
											"value": "@variables('Stream2')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2",
										"value": {
											"value": "@{add(int(variables('Stream2_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream1_Log_copy1",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1_copy1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 1_copy1').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 1_copy1').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream2'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 1_copy1').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 1_copy1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1_copy1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1_copy1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream3",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream3_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream3')), int(variables('Stream3_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 3",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 3').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 3').output.FirstRow.Js3,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 3",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js3 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream3'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream3 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3_Temp",
										"value": {
											"value": "@variables('Stream3')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream3 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream3 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3",
										"value": {
											"value": "@{add(int(variables('Stream3_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream3",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream3'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 3').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 3",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 3').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Set Stream1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Temp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1",
							"value": {
								"value": "@{activity('Lookup_cnt').output.value[0].srt_value}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup_cnt",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT  *  FROM stg.cnt_loaddistributor_delta where id = @{int(variables('id'))}",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set Stream1_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream1')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Temp",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_cnt",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Temp",
							"value": {
								"value": "@{div(add(sub(activity('Lookup_cnt').output.value[0].end_value,activity('Lookup_cnt').output.value[0].srt_value),1),3)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2",
							"value": {
								"value": "@{add(int(variables('Stream1_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream2')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3",
							"value": {
								"value": "@{add(int(variables('Stream2_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3_End",
							"value": {
								"value": "@{activity('Lookup_cnt').output.value[0].end_value}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Wait1",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream1",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Wait2",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream2",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Wait3",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream3",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"variables": {
					"Stream1": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_End": {
						"type": "String",
						"defaultValue": "100"
					},
					"Stream2": {
						"type": "String",
						"defaultValue": "101"
					},
					"Stream2_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream2_End": {
						"type": "String",
						"defaultValue": "200"
					},
					"Stream3": {
						"type": "String",
						"defaultValue": "201"
					},
					"Stream3_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream3_End": {
						"type": "String",
						"defaultValue": "300"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"Table_name": {
						"type": "String",
						"defaultValue": "stg.CoveoPushData_json_cnt_lookup_delta"
					},
					"Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Source": {
						"type": "String",
						"defaultValue": "xqzjpr66aahsdkjh6go4dycoca"
					},
					"id": {
						"type": "String",
						"defaultValue": "2"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/4 3 Delta_Partial_CNT_Push_3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Until_Stream1",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream1')), int(variables('Stream1_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1').output.FirstRow.Js1,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js1 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream1'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream1 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream1_Log",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1_Temp",
										"value": {
											"value": "@variables('Stream1')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1",
										"value": {
											"value": "@{add(int(variables('Stream1_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream1_Log",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 1').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream1'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 1').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream2",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream2')), int(variables('Stream2_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1_copy1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1_copy1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1_copy1').output.FirstRow.Js2,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1_copy1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js2 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream2'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream1 var_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream1_Log_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2_Temp",
										"value": {
											"value": "@variables('Stream2')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet_copy1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2",
										"value": {
											"value": "@{add(int(variables('Stream2_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream1_Log_copy1",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1_copy1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 1_copy1').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 1_copy1').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream2'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 1_copy1').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 1_copy1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1_copy1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1_copy1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream3",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Stream3_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream3')), int(variables('Stream3_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 3",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Coveo Stream Open 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 3').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 3').output.FirstRow.Js3,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 3",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "SELECT  Jsonstring as js3 FROM @{variables('Table_name')} \nwhere BatchNo=@{int(variables('Stream3'))}",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Stream3 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "SP_Update_Stream3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3_Temp",
										"value": {
											"value": "@variables('Stream3')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream3 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream3 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3",
										"value": {
											"value": "@{add(int(variables('Stream3_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "SP_Update_Stream3",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.fileId",
													"type": "Expression"
												},
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Coveo Stream Open 3').output.Uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@{int(variables('Stream3'))}",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Coveo Stream Chunk Push 3').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Coveo Stream Open 3",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 3').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Set Stream1",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Temp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1",
							"value": {
								"value": "@{activity('Lookup_cnt').output.value[0].srt_value}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup_cnt",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "SELECT  *  FROM stg.cnt_loaddistributor_delta where id = @{int(variables('id'))}",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set Stream1_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream1_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream1')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Temp",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup_cnt",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Temp",
							"value": {
								"value": "@{div(add(sub(activity('Lookup_cnt').output.value[0].end_value,activity('Lookup_cnt').output.value[0].srt_value),1),3)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream1_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2",
							"value": {
								"value": "@{add(int(variables('Stream1_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream2_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream2_End",
							"value": {
								"value": "@{sub(add(int(variables('Stream2')),int(variables('Temp'))),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream2_End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3",
							"value": {
								"value": "@{add(int(variables('Stream2_End')),1)}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set Stream3_End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Set Stream3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "Stream3_End",
							"value": {
								"value": "@{activity('Lookup_cnt').output.value[0].end_value}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Wait1",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream1",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Wait2",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream3",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Wait3",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Until_Stream2",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"variables": {
					"Stream1": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_End": {
						"type": "String",
						"defaultValue": "100"
					},
					"Stream2": {
						"type": "String",
						"defaultValue": "101"
					},
					"Stream2_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream2_End": {
						"type": "String",
						"defaultValue": "200"
					},
					"Stream3": {
						"type": "String",
						"defaultValue": "201"
					},
					"Stream3_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream3_End": {
						"type": "String",
						"defaultValue": "300"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"Table_name": {
						"type": "String",
						"defaultValue": "stg.CoveoPushData_json_cnt_lookup_delta"
					},
					"Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Source": {
						"type": "String",
						"defaultValue": "xqzjpr66aahsdkjh6go4dycoca"
					},
					"id": {
						"type": "String",
						"defaultValue": "3"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/4 4 Delta_Partial_CNT_Error_Batches_Repushing')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Error New Batches Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select\tmin(id) as RowStart,\n\t\tmax(id) as RowEnd \nfrom [stg].[CoveoPushdata_json_cnt_delta_error_records_New_Ranges]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps2",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": false
						}
					},
					{
						"name": "Set Start",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RowStart",
							"value": {
								"value": "@{activity('Lookup1').output.value[0].RowStart}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Set End",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"variableName": "RowEnd",
							"value": {
								"value": "@{activity('Lookup1').output.value[0].RowEnd}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Resending",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "Set Start",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set End",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(variables('RowStart'),variables('RowEnd'))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Coveo Stream Chunk Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Open 1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Lookup_cnt 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Coveo Stream Open 1').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"partialUpdate\": [',activity('Lookup_cnt 1').output.FirstRow.Jsonstring,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Coveo Push 1",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Temp",
										"value": {
											"value": "@{variables('RowStart')}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "RowStart",
										"value": {
											"value": "@{add(int(variables('Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Stream Open 1",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json",
											"Accept": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Coveo Push 1",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Coveo Stream Chunk Push 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Coveo Stream Open 1').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Lookup_cnt 1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @json nvarchar(max);\nSELECT  @json = coalesce(@json + ','+JSONSTRING,JSONSTRING) \nFROM (      select Jsonstring from [stg].[CoveoPushData_Json_cnt_partial_Delta_Update_Add]\n            where row_no>=(\tselect start_rowno from [stg].[CoveoPushdata_json_cnt_delta_error_records_New_Ranges]\n\t\t\t\t\t\t\twhere id =@{int(variables('RowStart'))}) and \n                  row_no<=(\tselect end_rowno from [stg].[CoveoPushdata_json_cnt_delta_error_records_New_Ranges]\n\t\t\t\t\t\t\twhere id =@{int(variables('RowStart'))})\n      ) a\nselect @json as Jsonstring",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								}
							],
							"timeout": "0.12:00:00"
						}
					},
					{
						"name": "Error New Batches Preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Script1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[stg].[CoveoPushdata_json_cnt_delta_error_records_maxpayload_again]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Script1",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "truncate table [stg].[CoveoPushdata_json_cnt_delta_error_records]\n\ninsert into [stg].[CoveoPushdata_json_cnt_delta_error_records](Batchno,ErrorMessage)\nselect BatchNo,Errormessage from stg.[CoveoPushData_cnt_stream1]\nwhere Errormessage like '%service is too large%'"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string",
						"defaultValue": "blackwoodsproductiondb4f7vq2"
					},
					"SourceID": {
						"type": "string",
						"defaultValue": "skmopt6atrldmbcplagqyg2kqa"
					},
					"BearerKey": {
						"type": "string",
						"defaultValue": "xx1b9103ee-5ac4-4917-a945-66f5b26def8b"
					}
				},
				"variables": {
					"RowStart": {
						"type": "String"
					},
					"RowEnd": {
						"type": "String"
					},
					"Temp": {
						"type": "String"
					},
					"Empty_Body": {
						"type": "String",
						"defaultValue": "{}"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/2 1 Delta_initial_load_Update')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Lookup1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@less(int(activity('Lookup1').output.firstRow.cnt),18)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Update count",
									"type": "Lookup",
									"dependsOn": [
										{
											"activity": "Load Distributor",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "select * from stg.coveopushdata_initialload_loaddistributor_delta",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										},
										"firstRowOnly": false
									}
								},
								{
									"name": "Stream1 123",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Update count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 1 2 Delta_initial_update_Push",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"start1": {
												"value": "@{activity('Update count').output.value[0].Batch_start}",
												"type": "Expression"
											},
											"end1": {
												"value": "@{activity('Update count').output.value[0].Batch_end}",
												"type": "Expression"
											},
											"start2": {
												"value": "@{activity('Update count').output.value[1].Batch_start}",
												"type": "Expression"
											},
											"end2": {
												"value": "@{activity('Update count').output.value[1].Batch_end}",
												"type": "Expression"
											},
											"start3": {
												"value": "@{activity('Update count').output.value[2].Batch_start}",
												"type": "Expression"
											},
											"end3": {
												"value": "@{activity('Update count').output.value[2].Batch_end}",
												"type": "Expression"
											},
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Load Distributor",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[coveopushdata_initialload_loaddistributor_delta]",
										"storedProcedureParameters": {
											"parallelstreams": {
												"value": "18",
												"type": "Int32"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								},
								{
									"name": "Stream2 456",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Update count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 1 2 Delta_initial_update_Push",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"start1": {
												"value": "@{activity('Update count').output.value[3].Batch_start}",
												"type": "Expression"
											},
											"end1": {
												"value": "@{activity('Update count').output.value[3].Batch_end}",
												"type": "Expression"
											},
											"start2": {
												"value": "@{activity('Update count').output.value[4].Batch_start}",
												"type": "Expression"
											},
											"end2": {
												"value": "@{activity('Update count').output.value[4].Batch_end}",
												"type": "Expression"
											},
											"start3": {
												"value": "@{activity('Update count').output.value[5].Batch_start}",
												"type": "Expression"
											},
											"end3": {
												"value": "@{activity('Update count').output.value[5].Batch_end}",
												"type": "Expression"
											},
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Stream3 789",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Update count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 1 2 Delta_initial_update_Push",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"start1": {
												"value": "@{activity('Update count').output.value[6].Batch_start}",
												"type": "Expression"
											},
											"end1": {
												"value": "@{activity('Update count').output.value[6].Batch_end}",
												"type": "Expression"
											},
											"start2": {
												"value": "@{activity('Update count').output.value[7].Batch_start}",
												"type": "Expression"
											},
											"end2": {
												"value": "@{activity('Update count').output.value[7].Batch_end}",
												"type": "Expression"
											},
											"start3": {
												"value": "@{activity('Update count').output.value[8].Batch_start}",
												"type": "Expression"
											},
											"end3": {
												"value": "@{activity('Update count').output.value[8].Batch_end}",
												"type": "Expression"
											},
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Stream4 101112",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Update count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 1 2 Delta_initial_update_Push",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"start1": {
												"value": "@{activity('Update count').output.value[9].Batch_start}",
												"type": "Expression"
											},
											"end1": {
												"value": "@{activity('Update count').output.value[9].Batch_end}",
												"type": "Expression"
											},
											"start2": {
												"value": "@{activity('Update count').output.value[10].Batch_start}",
												"type": "Expression"
											},
											"end2": {
												"value": "@{activity('Update count').output.value[10].Batch_end}",
												"type": "Expression"
											},
											"start3": {
												"value": "@{activity('Update count').output.value[11].Batch_start}",
												"type": "Expression"
											},
											"end3": {
												"value": "@{activity('Update count').output.value[11].Batch_end}",
												"type": "Expression"
											},
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Stream5 131415",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Update count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 1 2 Delta_initial_update_Push",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"start1": {
												"value": "@{activity('Update count').output.value[12].Batch_start}",
												"type": "Expression"
											},
											"end1": {
												"value": "@{activity('Update count').output.value[12].Batch_end}",
												"type": "Expression"
											},
											"start2": {
												"value": "@{activity('Update count').output.value[13].Batch_start}",
												"type": "Expression"
											},
											"end2": {
												"value": "@{activity('Update count').output.value[13].Batch_end}",
												"type": "Expression"
											},
											"start3": {
												"value": "@{activity('Update count').output.value[14].Batch_start}",
												"type": "Expression"
											},
											"end3": {
												"value": "@{activity('Update count').output.value[14].Batch_end}",
												"type": "Expression"
											},
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Stream6 161718",
									"type": "ExecutePipeline",
									"dependsOn": [
										{
											"activity": "Update count",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 1 2 Delta_initial_update_Push",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"start1": {
												"value": "@{activity('Update count').output.value[15].Batch_start}",
												"type": "Expression"
											},
											"end1": {
												"value": "@{activity('Update count').output.value[15].Batch_end}",
												"type": "Expression"
											},
											"start2": {
												"value": "@{activity('Update count').output.value[16].Batch_start}",
												"type": "Expression"
											},
											"end2": {
												"value": "@{activity('Update count').output.value[16].Batch_end}",
												"type": "Expression"
											},
											"start3": {
												"value": "@{activity('Update count').output.value[17].Batch_start}",
												"type": "Expression"
											},
											"end3": {
												"value": "@{activity('Update count').output.value[17].Batch_end}",
												"type": "Expression"
											},
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Lookup_cnt 1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @json nvarchar(max);\nSELECT  @json = coalesce(@json + ','+JSONSTRING,JSONSTRING) FROM\n(select Jsonstring from stg.coveopushdata_json_wo_csp_cnt_delta_update\n) a\nselect @json as Jsonstring",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										}
									}
								},
								{
									"name": "Create S3 File Container",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/json",
											"Accept": "application/json",
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											}
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Data To Container",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Lookup_cnt 1",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Create S3 File Container",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Create S3 File Container').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@activity('Lookup_cnt 1').output.FirstRow.Jsonstring",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Container to Stream",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Push Data To Container",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Create S3 File Container').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Intial Load woCspCnt Update Log",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Push Container to Stream",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CoveoPushData_wo_csp_cnt_Delta_Update_log]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": null,
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Create S3 File Container').output.uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": "1",
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Push Container to Stream').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					},
					{
						"name": "Lookup1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select count(*) cnt from stg.coveopushdata_json_wo_csp_cnt_delta_update",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"variables": {
					"Stream1": {
						"type": "String",
						"defaultValue": "45001"
					},
					"Stream1_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_End": {
						"type": "String",
						"defaultValue": "60000"
					},
					"Stream2": {
						"type": "String",
						"defaultValue": "60001"
					},
					"Stream2_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream2_End": {
						"type": "String",
						"defaultValue": "75000"
					},
					"Stream3": {
						"type": "String",
						"defaultValue": "75001"
					},
					"Stream3_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream3_End": {
						"type": "String",
						"defaultValue": "90000"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"Table_name": {
						"type": "String",
						"defaultValue": "stg.CoveoPushData_json_wo_csp_cnt_delta_update"
					},
					"Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Source": {
						"type": "String",
						"defaultValue": "xqzjpr66aahsdkjh6go4dycoca"
					},
					"id": {
						"type": "String",
						"defaultValue": "2"
					},
					"Stream4": {
						"type": "String",
						"defaultValue": "90001"
					},
					"Stream4_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream4_End": {
						"type": "String",
						"defaultValue": "106420"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/2 1 Initial Load - Coveo BWProducts Parallel_Chunks_v1_90')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Coveo Stream Open Initial Load",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Truncate logs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/open\n",
								"type": "Expression"
							},
							"method": "POST",
							"headers": {
								"Authorization": {
									"value": "Bearer @{pipeline().parameters.BearerKey}",
									"type": "Expression"
								},
								"Content-Type": "application/json",
								"Accept": "application/json"
							},
							"body": {
								"value": "@variables('empty_body')",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Lookup-1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Coveo Stream Open Initial Load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "DECLARE @json nvarchar(max);\nSELECT  @json = coalesce(@json + ','+JSONSTRING,JSONSTRING) \nFROM (      select Jsonstring from stg.coveopushdata_json_wo_csp_cnt\n            where row_no>=1 and \n                  row_no<=100\n                  and is_jsonstring_valid=1\n      ) a\nselect @json as Jsonstring",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps",
								"type": "DatasetReference",
								"parameters": {}
							},
							"firstRowOnly": true
						}
					},
					{
						"name": "Coveo Push",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Lookup-1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "@activity('Coveo Stream Open Initial Load').output.uploadURI",
								"type": "Expression"
							},
							"method": "PUT",
							"headers": {
								"x-amz-server-side-encryption": "AES256",
								"Content-Type": "application/octet-stream"
							},
							"body": {
								"value": "@concat('{\"AddOrUpdate\": [',activity('Lookup-1').output.firstRow.Jsonstring,\n']}')",
								"type": "Expression"
							},
							"httpRequestTimeout": "00:10:00"
						}
					},
					{
						"name": "Product Intial Load 1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "1",
								"param2": "2",
								"param3": "3",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log1]",
								"param4": "4",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Load Distributor",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP_Update_Coveopushdata_json_wo_cnt_csp",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[coveopushdata_initialload_loaddistributor]",
							"storedProcedureParameters": {
								"parallelstreams": {
									"value": "80",
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Product Intial Load 2",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "5",
								"param2": "6",
								"param3": "7",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log1]",
								"param4": "8",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 3",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "9",
								"param2": "10",
								"param3": "11",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log1]",
								"param4": "12",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 4",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "13",
								"param2": "14",
								"param3": "15",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log1]",
								"param4": "16",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 5",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "17",
								"param2": "18",
								"param3": "19",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log2]",
								"param4": "20",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 8",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "29",
								"param2": "30",
								"param3": "31",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log2]",
								"param4": "32",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 7",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "25",
								"param2": "26",
								"param3": "27",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log2]",
								"param4": "28",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 6",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "21",
								"param2": "22",
								"param3": "23",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log2]",
								"param4": "24",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 12",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "45",
								"param2": "46",
								"param3": "47",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log3]",
								"param4": "48",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 11",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "41",
								"param2": "42",
								"param3": "43",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log3]",
								"param4": "44",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 10",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "37",
								"param2": "38",
								"param3": "39",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log3]",
								"param4": "40",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 9",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "33",
								"param2": "34",
								"param3": "35",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log3]",
								"param4": "36",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 15",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "57",
								"param2": "58",
								"param3": "59",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log4]",
								"param4": "60",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 14",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "53",
								"param2": "54",
								"param3": "55",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log4]",
								"param4": "56",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 13",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "49",
								"param2": "50",
								"param3": "51",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log4]",
								"param4": "52",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 17",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "65",
								"param2": "66",
								"param3": "67",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log5]",
								"param4": "68",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 16",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "61",
								"param2": "62",
								"param3": "63",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log4]",
								"param4": "64",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 18",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "69",
								"param2": "70",
								"param3": "71",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log5]",
								"param4": "72",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 19",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "73",
								"param2": "74",
								"param3": "75",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log5]",
								"param4": "76",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Product Intial Load 20",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 2 Product_Intial_Load Chnunks",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"uploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"batchsize": {
									"value": "@variables('batchSize')",
									"type": "Expression"
								},
								"param1": "77",
								"param2": "78",
								"param3": "79",
								"logStoredProcedure": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log5]",
								"param4": "80",
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Wait2",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Coveo Stream Close Initial Load_copy1",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 5
						}
					},
					{
						"name": "BPart Call",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 3 BPart_Product_Intial_Load",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"UploadURI": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								},
								"Fileid": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Availability Intial Load 123",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 2 Availability_Intial_Load",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"StreamID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.streamid",
									"type": "Expression"
								},
								"fileID": {
									"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Coveo Stream Close Initial Load_copy1",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Execute Pipeline1",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": {
								"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/@{activity('Coveo Stream Open Initial Load').output.streamid}/close",
								"type": "Expression"
							},
							"method": "POST",
							"headers": {
								"Authorization": {
									"value": "Bearer @{pipeline().parameters.BearerKey}",
									"type": "Expression"
								}
							},
							"body": {
								"value": "@variables('empty_body')",
								"type": "Expression"
							},
							"httpRequestTimeout": "00:10:00"
						}
					},
					{
						"name": "Wait3",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Product Intial Load 1",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 2",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 3",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 4",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 5",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 8",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 7",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 6",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 12",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 11",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 10",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 9",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 15",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 14",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 13",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 17",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 16",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 18",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 19",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Product Intial Load 20",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "BPart Call",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "Availability Intial Load 123",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Execute Pipeline1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Wait3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 4 Error Records Reconciliation",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrgID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SrcID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BeaereKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"streamid": {
									"value": "@{activity('Coveo Stream Open Initial Load').output.streamid}",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "SP_Update_Coveopushdata_json_wo_cnt_csp",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Coveo Push",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Update_coveopushdata_json_wo_csp_cnt_web_log1]",
							"storedProcedureParameters": {
								"AWSContainerFileID": {
									"value": {
										"value": "@activity('Coveo Stream Open Initial Load').output.fileId",
										"type": "Expression"
									},
									"type": "String"
								},
								"AWSUploadURI": {
									"value": {
										"value": "@activity('Coveo Stream Open Initial Load').output.Uploaduri",
										"type": "Expression"
									},
									"type": "String"
								},
								"BAtchNoStart": {
									"value": "1",
									"type": "Int32"
								},
								"PipelineID": {
									"value": {
										"value": "@pipeline().RunId",
										"type": "Expression"
									},
									"type": "String"
								},
								"ErrorMessage": {
									"value": {
										"value": "@activity('Coveo Push').Error?.message",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Copy logs",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "insert into stg.coveopushdata_wo_csp_cnt_web_log\nselect * from stg.coveopushdata_wo_csp_cnt_web_log1 \ninsert into stg.coveopushdata_wo_csp_cnt_web_log\nselect * from stg.CoveoPushData_wo_csp_cnt_web_log2\ninsert into stg.coveopushdata_wo_csp_cnt_web_log\nselect * from stg.CoveoPushData_wo_csp_cnt_web_log3\ninsert into stg.coveopushdata_wo_csp_cnt_web_log\nselect * from stg.CoveoPushData_wo_csp_cnt_web_log6\ninsert into stg.coveopushdata_wo_csp_cnt_web_log\nselect * from stg.CoveoPushData_wo_csp_cnt_web_log4\ninsert into stg.coveopushdata_wo_csp_cnt_web_log\nselect * from stg.CoveoPushData_wo_csp_cnt_web_log5"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					},
					{
						"name": "Truncate logs",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Copy logs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "truncate table stg.coveopushdata_wo_csp_cnt_web_log1\ntruncate table stg.coveopushdata_wo_csp_cnt_web_log2\ntruncate table stg.coveopushdata_wo_csp_cnt_web_log3\ntruncate table stg.coveopushdata_wo_csp_cnt_web_log4\ntruncate table stg.coveopushdata_wo_csp_cnt_web_log5\ntruncate table stg.coveopushdata_wo_csp_cnt_web_log6"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"variables": {
					"Availability_cur_cnt": {
						"type": "String",
						"defaultValue": "1"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"availability_max_cnt": {
						"type": "String",
						"defaultValue": "5"
					},
					"temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"until1_start": {
						"type": "String",
						"defaultValue": "2"
					},
					"until2_start": {
						"type": "String",
						"defaultValue": "11"
					},
					"until2_end": {
						"type": "String",
						"defaultValue": "20"
					},
					"until1_temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"until2_temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"until3_start": {
						"type": "String",
						"defaultValue": "21"
					},
					"until3_end": {
						"type": "String",
						"defaultValue": "30"
					},
					"until3_temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"until4_start": {
						"type": "String",
						"defaultValue": "31"
					},
					"until4_end": {
						"type": "String",
						"defaultValue": "40"
					},
					"until4_temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"batchSize": {
						"type": "String",
						"defaultValue": "100"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Full Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/2 4 1 Delta_BPart_Add_Update')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Until_Stream1",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "If Condition1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream1')), int(variables('Stream1_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Lookup_cnt 1",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @json nvarchar(max);\nSELECT  @json = coalesce(@json + ','+JSONSTRING,JSONSTRING) FROM\n(     select Jsonstring \n      from stg.coveopushdata_json_BPart_Delta_Lookup\n      where batchno=@{int(variables('Stream1'))} \n) a\nselect @json as Jsonstring",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										},
										"firstRowOnly": false
									}
								},
								{
									"name": "Stream1 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Intial Load BPart Update Add Log_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1_Temp",
										"value": {
											"value": "@variables('Stream1')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream1 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream1 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1",
										"value": {
											"value": "@{add(int(variables('Stream1_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Create S3 File Container",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/json",
											"Accept": "application/json",
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											}
										},
										"body": {
											"value": "@{variables('empty_body')}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Data To Container",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Create S3 File Container",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Lookup_cnt 1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Create S3 File Container').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"addOrUpdate\": [',activity('Lookup_cnt 1').output.value[0].Jsonstring,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Container to Stream",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Push Data To Container",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Create S3 file container').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Intial Load BPart Update Add Log_copy1",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Push Data To Container",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CoveoPushData_bpart_Delta_Update_add_log]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": null,
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Create S3 File Container').output.uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@int(variables('Stream1'))",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Create S3 File Container').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Get rows Add Update",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Copy logs to history",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select max(batchno) cnt from stg.coveopushdata_json_BPart_Delta_Lookup",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Until_Stream2",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "If Condition1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream2')), int(variables('Stream2_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Lookup_cnt 2",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @json nvarchar(max);\nSELECT  @json = coalesce(@json + ','+JSONSTRING,JSONSTRING) FROM\n(     select Jsonstring \n      from stg.coveopushdata_json_BPart_Delta_Lookup\n      where batchno=@{int(variables('Stream2'))} \n) a\nselect @json as Jsonstring",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										},
										"firstRowOnly": false
									}
								},
								{
									"name": "Stream2 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Intial Load BPart Update Add Log",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2_Temp",
										"value": {
											"value": "@variables('Stream2')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream2 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream2 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2",
										"value": {
											"value": "@{add(int(variables('Stream2_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Create S3 File Container 2",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/json",
											"Accept": "application/json",
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											}
										},
										"body": {
											"value": "@{variables('empty_body')}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Data To Container 2",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Create S3 File Container 2",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Lookup_cnt 2",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Create S3 File Container 2').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"addOrUpdate\": [',activity('Lookup_cnt 2').output.value[0].Jsonstring,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Container to Stream 2",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Push Data To Container 2",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Create S3 File container 2').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Intial Load BPart Update Add Log",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Push Data To Container 2",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CoveoPushData_bpart_Delta_Update_add_log]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": null,
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Create S3 File Container 2').output.uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@int(variables('Stream2'))",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Create S3 File Container 2').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "Until_Stream3",
						"type": "Until",
						"dependsOn": [
							{
								"activity": "If Condition1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greater(int(variables('Stream3')), int(variables('Stream3_End')))",
								"type": "Expression"
							},
							"activities": [
								{
									"name": "Lookup_cnt 3",
									"type": "Lookup",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "AzureSqlSource",
											"sqlReaderQuery": {
												"value": "DECLARE @json nvarchar(max);\nSELECT  @json = coalesce(@json + ','+JSONSTRING,JSONSTRING) FROM\n(     select Jsonstring \n      from stg.coveopushdata_json_BPart_Delta_Lookup\n      where batchno=@{int(variables('Stream3'))} \n) a\nselect @json as Jsonstring",
												"type": "Expression"
											},
											"queryTimeout": "02:00:00",
											"partitionOption": "None"
										},
										"dataset": {
											"referenceName": "destination_BlackOps1",
											"type": "DatasetReference",
											"parameters": {}
										},
										"firstRowOnly": false
									}
								},
								{
									"name": "Stream3 var",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Intial Load BPart Update Add Log_copy2",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3_Temp",
										"value": {
											"value": "@variables('Stream3')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Stream3 varSet",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Stream3 var",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3",
										"value": {
											"value": "@{add(int(variables('Stream3_Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Create S3 File Container 3",
									"type": "WebActivity",
									"dependsOn": [],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/files?useVirtualHostedStyleUrl=true",
											"type": "Expression"
										},
										"method": "POST",
										"headers": {
											"Content-Type": "application/json",
											"Accept": "application/json",
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											}
										},
										"body": {
											"value": "@{variables('empty_body')}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Data To Container 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Create S3 File Container 3",
											"dependencyConditions": [
												"Succeeded"
											]
										},
										{
											"activity": "Lookup_cnt 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 2,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "@activity('Create S3 File Container 3').output.uploadURI",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"x-amz-server-side-encryption": "AES256",
											"Content-Type": "application/octet-stream"
										},
										"body": {
											"value": "@concat('{\"addOrUpdate\": [',activity('Lookup_cnt 3').output.value[0].Jsonstring,']}')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Push Container to Stream 3",
									"type": "WebActivity",
									"dependsOn": [
										{
											"activity": "Push Data To Container 3",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"url": {
											"value": "https://api-au.cloud.coveo.com/push/v1/organizations/@{pipeline().parameters.OrganizationID}/sources/@{pipeline().parameters.OrganizationID}-@{pipeline().parameters.SourceID}/stream/update?fileId=@{activity('Create S3 file container 3').output.fileid}",
											"type": "Expression"
										},
										"method": "PUT",
										"headers": {
											"Authorization": {
												"value": "Bearer @{pipeline().parameters.BearerKey}",
												"type": "Expression"
											},
											"Content-Type": "application/json"
										},
										"body": {
											"value": "@variables('empty_body')",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Intial Load BPart Update Add Log_copy2",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "Push Data To Container 3",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"policy": {
										"timeout": "7.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[CoveoPushData_bpart_Delta_Update_add_log]",
										"storedProcedureParameters": {
											"AWSContainerFileID": {
												"value": null,
												"type": "String"
											},
											"AWSUploadURI": {
												"value": {
													"value": "@activity('Create S3 File Container 3').output.uploaduri",
													"type": "Expression"
												},
												"type": "String"
											},
											"BAtchNoStart": {
												"value": {
													"value": "@int(variables('Stream3'))",
													"type": "Expression"
												},
												"type": "Int32"
											},
											"PipelineID": {
												"value": {
													"value": "@pipeline().RunId",
													"type": "Expression"
												},
												"type": "String"
											},
											"ErrorMessage": {
												"value": {
													"value": "@activity('Create S3 File Container 3').Error?.Message",
													"type": "Expression"
												},
												"type": "String"
											}
										}
									},
									"linkedServiceName": {
										"referenceName": "AzureSqlDatabase1",
										"type": "LinkedServiceReference"
									}
								}
							],
							"timeout": "7.00:00:00"
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get rows Add Update",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@greaterOrEquals(int(activity('Get rows Add Update').output.firstRow.cnt),3)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Set stream1_copy1",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1",
										"value": "1"
									}
								},
								{
									"name": "Set stream1 End_copy1",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1_End",
										"value": {
											"value": "@{activity('Get rows Add Update').output.firstRow.cnt}",
											"type": "Expression"
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Set stream1",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Temp",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1",
										"value": "1"
									}
								},
								{
									"name": "Set stream1 End",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Temp",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream1_End",
										"value": {
											"value": "@{int(variables('Temp'))}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set stream2",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Temp",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2",
										"value": {
											"value": "@{add(int(variables('Temp')),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set stream2 End",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Temp",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream2_End",
										"value": {
											"value": "@{mul(int(variables('Temp')),2)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Temp",
									"type": "SetVariable",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Temp",
										"value": {
											"value": "@{div(int(activity('Get rows Add Update').output.firstRow.cnt),3)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set stream3",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Temp",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3",
										"value": {
											"value": "@{add(mul(int(variables('Temp')),2),1)}",
											"type": "Expression"
										}
									}
								},
								{
									"name": "Set stream3 End",
									"type": "SetVariable",
									"dependsOn": [
										{
											"activity": "Temp",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"variableName": "Stream3_End",
										"value": {
											"value": "@{int(activity('Get rows Add Update').output.firstRow.cnt)}",
											"type": "Expression"
										}
									}
								}
							]
						}
					},
					{
						"name": "Copy logs to history",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "insert into [stg].[CoveoPushData_bpart_Delta_Update_add_log_history]\nselect * from [stg].[CoveoPushData_bpart_Delta_Update_add_log]\n\ntruncate table [stg].[CoveoPushData_bpart_Delta_Update_add_log]"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					},
					{
						"name": "Fetch error batches count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Until_Stream3",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Until_Stream2",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Until_Stream1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select count(*) as total from [stg].[CoveoPushData_bpart_Delta_Update_add_log]\nwhere Errormessage like '%service is too large%'\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps2",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "If Condition1_copy1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Fetch error batches count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('Fetch error batches count').output.firstRow.total,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Execute Pipeline4_copy1",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "4 4 Delta_Partial_CNT_Error_Batches_Repushing",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Wait1_copy1",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string",
						"defaultValue": "blackwoodsproductiondb4f7vq2"
					},
					"SourceID": {
						"type": "string",
						"defaultValue": "skmopt6atrldmbcplagqyg2kqa"
					},
					"BearerKey": {
						"type": "string",
						"defaultValue": "xx1b9103ee-5ac4-4917-a945-66f5b26def8b"
					}
				},
				"variables": {
					"Stream1": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_Temp": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream1_End": {
						"type": "String",
						"defaultValue": "2452"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"Stream2": {
						"type": "String",
						"defaultValue": "2"
					},
					"Stream2_Temp": {
						"type": "String"
					},
					"Stream2_End": {
						"type": "String",
						"defaultValue": "1"
					},
					"Stream3": {
						"type": "String",
						"defaultValue": "2"
					},
					"Stream3_Temp": {
						"type": "String"
					},
					"Stream3_End": {
						"type": "String",
						"defaultValue": "1"
					},
					"Temp": {
						"type": "String"
					},
					"batchsize": {
						"type": "String",
						"defaultValue": "100"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/4 4 Delta_Partial_CNT_Error_Batches_Repushing')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/3 Coveo_CNT_partial_1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CNT data Push to Coveo 1 1",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationId",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup1",
								"id": "1",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]"
							}
						}
					},
					{
						"name": "CNT data Push to Coveo 1 2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_2",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationId",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup1",
								"id": "1",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]"
							}
						}
					},
					{
						"name": "CNT data Push to Coveo 1 3",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_3",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationId",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup1",
								"id": "1",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream1]"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationId": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Full Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partilal_PUSH_3')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/3 Coveo_CNT_partial_2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CNT data Push to Coveo 2 1",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup2",
								"id": "2",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream2]"
							}
						}
					},
					{
						"name": "CNT data Push to Coveo 2 2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_2",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup2",
								"id": "2",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream2]"
							}
						}
					},
					{
						"name": "CNT data Push to Coveo 2 3",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_3",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup2",
								"id": "2",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream2]"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Full Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partilal_PUSH_3')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/3 Coveo_CNT_partial_3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lk3 1",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup3",
								"id": "3",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream3]"
							}
						}
					},
					{
						"name": "Lk3 2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_2",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup3",
								"id": "3",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream3]"
							}
						}
					},
					{
						"name": "Lk3 3",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_3",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup3",
								"id": "3",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream3]"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SourceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Full Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partilal_PUSH_3')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/3 Coveo_CNT_partial_4')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Lk4 1",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SoruceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup4",
								"id": "4",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream4]"
							}
						}
					},
					{
						"name": "Lk4 3",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_3",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SoruceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup4",
								"id": "4",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream4]"
							}
						}
					},
					{
						"name": "Lk4 2",
						"type": "ExecutePipeline",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partilal_PUSH_2",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SoruceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								},
								"Table_name": "stg.CoveoPushData_json_cnt_lookup4",
								"id": "4",
								"StoredProcedureName": "[[dbo].[Update_coveopushdata_json_cnt_stream4]"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string"
					},
					"SoruceID": {
						"type": "string"
					},
					"BearerKey": {
						"type": "string"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Full Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partilal_PUSH_3')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/3 Delta_Partial_BOPS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "SP Day1 TO Day0 BOPS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_Bops_Partial_Delta]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Update New Delete records Preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "SP Day1 TO Day0 BOPS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_bops_Partial_Delta_Update_Add]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get rows count Add Update Delete",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Update New Delete records Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "select count(*) cnt from stg.coveopushdata_json_bops_partial_Delta_update_Add",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Get rows count Add Update Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(int(activity('Get rows count Add Update Delete').output.firstRow.cnt),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Call BOPS push",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "3 1 Delta_Partial_BOPS_Push_call",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Wait1",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string",
						"defaultValue": "blackwoodsnonproduction18ywd51dd"
					},
					"SourceID": {
						"type": "string",
						"defaultValue": "wfprngzh3psutpsinc7po7sl4u"
					},
					"BearerKey": {
						"type": "string",
						"defaultValue": "xxe4ddf465-208c-4042-951f-6a4e4339fa46"
					}
				},
				"variables": {
					"Stream1": {
						"type": "String"
					},
					"Stream1_End": {
						"type": "String"
					},
					"Stream1_Temp": {
						"type": "String"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/4 Delta_Partial_CNT')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Day0 Day1 cnt data preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy logs to history",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_CNT_Partial_Delta]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delta records - Add Update Delete",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Day0 Day1 cnt data preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_CNT_Partial_Delta_Update_Add]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Maxpayload",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delta records - Add Update Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_JSON_cnt_Delta_MaxPayload]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Lookup group",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Maxpayload",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_cnt_lookup_delta]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Distributor",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Lookup group",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "declare @max int\nset @max=(select max(batchno) from STG.CoveoPushData_Json_cnt_lookup_delta)\ntruncate table stg.cnt_loaddistributor_delta\ninsert into stg.cnt_loaddistributor_delta\nvalues(1,1,@max/3,GETDATE()),\n(2,(@max/3)+1,(@max/3)*2,GETDATE()),\n(3,((@max/3)*2)+1,@max,GETDATE())"
								}
							]
						}
					},
					{
						"name": "Execute Pipeline1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "4 1 Delta_Partial_CNT_Push_1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Execute Pipeline2",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "4 2 Delta_Partial_CNT_Push_2",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Execute Pipeline3",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Load Distributor",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "4 3 Delta_Partial_CNT_Push_3",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@pipeline().parameters.OrganizationID",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@pipeline().parameters.SourceID",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@pipeline().parameters.BearerKey",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Copy logs to history",
						"type": "Script",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "insert into stg.[CoveoPushData_cnt_stream_delta_history_log]\nselect * from stg.[CoveoPushData_cnt_stream1]\n\ntruncate table stg.[CoveoPushData_cnt_stream1]"
								}
							],
							"scriptBlockExecutionTimeout": "02:00:00"
						}
					},
					{
						"name": "Fetch error batches count",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Execute Pipeline1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Execute Pipeline2",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Execute Pipeline3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select count(*) as total from stg.[CoveoPushData_cnt_stream1]\nwhere Errormessage like '%service is too large%'\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps2",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Fetch error batches count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(activity('Fetch error batches count').output.firstRow.total,0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Execute Pipeline4",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "4 4 Delta_Partial_CNT_Error_Batches_Repushing",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"OrganizationID": {
												"value": "@pipeline().parameters.OrganizationID",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@pipeline().parameters.SourceID",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@pipeline().parameters.BearerKey",
												"type": "Expression"
											}
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Wait1",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"OrganizationID": {
						"type": "string",
						"defaultValue": "blackwoodsnonproduction18ywd51dd"
					},
					"SourceID": {
						"type": "string",
						"defaultValue": "wfprngzh3psutpsinc7po7sl4u"
					},
					"BearerKey": {
						"type": "string",
						"defaultValue": "xxe4ddf465-208c-4042-951f-6a4e4339fa46"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/4 1 Delta_Partial_CNT_Push_1')]",
				"[concat(variables('factoryId'), '/pipelines/4 2 Delta_Partial_CNT_Push_2')]",
				"[concat(variables('factoryId'), '/pipelines/4 3 Delta_Partial_CNT_Push_3')]",
				"[concat(variables('factoryId'), '/pipelines/4 4 Delta_Partial_CNT_Error_Batches_Repushing')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/1 Delta Load - Push Data to Coveo - Main ADF Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Coveo Day1 and Day0 Preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CoveoPushData Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_WO_CSP_CNT_Delta]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Coveo Delta - Update",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Coveo Day1 and Day0 Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_WO_CSP_CNT_Delta_Update]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Coveo Delta - Delete",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Coveo Day1 and Day0 Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_WO_CSP_CNT_Delta_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Coveo Delta - Add",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Coveo Day1 and Day0 Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_WO_CSP_CNT_Delta_Add]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CoveoPushData Preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Load_CoveoPushData]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BPart Delta",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Grouping products Lookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 4 1 Delta_BPart_Add_Update",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('OrganizationID')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('SourceID')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Delta CNT",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Wait6",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "4 Delta_Partial_CNT",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('OrganizationID')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('SourceID')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Availability Intial Load 123",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Step1-Load_CoveoPushData_Availability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 5 Delta_Availability",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('OrganizationID')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('SourceID')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Update",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(int(activity('Update').output.firstRow.cnt),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Delta Update Pipeline Call",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 1 Delta_initial_load_Update",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"OrganizationID": {
												"value": "@variables('OrganizationID')",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@variables('SourceID')",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@variables('BearerKey')",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Wait2",
									"type": "Wait",
									"dependsOn": [
										{
											"activity": "Delta Update Pipeline Call",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Wait1",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							]
						}
					},
					{
						"name": "Update",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Coveo Delta - Lookup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select count(*) cnt from stg.coveopushdata_json_wo_csp_cnt_delta_update",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "If Condition Delete",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(int(activity('Delete').output.firstRow.cnt),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Delta Delete Pipeline Call",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 2 Delta_initial_load_Delete",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"OrganizationID": {
												"value": "@variables('OrganizationID')",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@variables('SourceID')",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@variables('BearerKey')",
												"type": "Expression"
											}
										}
									}
								},
								{
									"name": "Wait3",
									"type": "Wait",
									"dependsOn": [
										{
											"activity": "Delta Delete Pipeline Call",
											"dependencyConditions": [
												"Succeeded",
												"Failed"
											]
										}
									],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Wait1_copy1",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							]
						}
					},
					{
						"name": "Delete",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Coveo Delta - Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select count(*) cnt from stg.coveopushdata_json_wo_csp_cnt_delta_delete",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "Add",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Coveo Delta - Add",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select count(*) cnt from stg.coveopushdata_json_wo_csp_cnt_delta_add",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "destination_BlackOps1",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "If Condition Add",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "Add",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(int(activity('add').output.firstRow.cnt),0)",
								"type": "Expression"
							},
							"ifFalseActivities": [
								{
									"name": "Delta Add Pipeline Call",
									"type": "ExecutePipeline",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"pipeline": {
											"referenceName": "2 3 Delta_initial_load_Add",
											"type": "PipelineReference"
										},
										"waitOnCompletion": true,
										"parameters": {
											"OrganizationID": {
												"value": "@variables('OrganizationID')",
												"type": "Expression"
											},
											"SourceID": {
												"value": "@variables('SourceID')",
												"type": "Expression"
											},
											"BearerKey": {
												"value": "@variables('BearerKey')",
												"type": "Expression"
											}
										}
									}
								}
							],
							"ifTrueActivities": [
								{
									"name": "Wait1_copy1_copy1",
									"type": "Wait",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"waitTimeInSeconds": 1
									}
								}
							]
						}
					},
					{
						"name": "Delta BOPS",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Wait6",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Delta_Partial_BOPS",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('OrganizationID')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('SourceID')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Step1-Load_CoveoPushData_Availability",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Load_CoveoPushData_availability]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Coveo Delta - Max Payload",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Coveo Delta - Update",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_JSON_WO_CSP_CNT_Delta_Max_Payload]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Coveo Delta - Lookup",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Coveo Delta - Max Payload",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_wo_csp_cnt_Delta_lookup]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Bpart Update Add New Records preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "1 BPart JSON preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_BPart_Delta_Add_Update_delete]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "1 BPart JSON preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_BPart_Delta]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete Bpart Delta",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Bpart Update Add New Records preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 4 2 Delta_Bpart_Delete",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('OrganizationID')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('SourceID')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "maxpayload Calculation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Bpart Update Add New Records preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_JSON_BPart_Delta_Max_Payload]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Grouping products Lookup",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "maxpayload Calculation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_BPart_Delta_lookup]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Wait4",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Availability Intial Load 123",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Wait5",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Delta BOPS",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 1
						}
					},
					{
						"name": "Error Mail Notification",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Delete Bpart Delta",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-14.southeastasia.logic.azure.com:443/workflows/b5dccf7903484ee1b6c772c3a8aa0f51/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uhVEhHPsZNiltHdyvFv5ZGDfRXHequxZ6hM7Dvt0QIw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"value": "{\n    \"ADFName\":\"@{pipeline().DataFactory}\",\n    \"ErrorMessage\":\"@{activity('Delete Bpart Delta').Error.Message}\",\n    \"PipelineName\":\"@{pipeline().Pipeline}\"\n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Wait6",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "If Condition1",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "If Condition Delete",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							},
							{
								"activity": "If Condition Add",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 600
						}
					},
					{
						"name": "Data Reconciliation",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Delta CNT",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "BPart Delta",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Wait4",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Wait5",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Delete Bpart Delta",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "5 BlackOps_Coveo_Data_Reconciliation",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"OrganizationID": {
						"type": "String",
						"defaultValue": "blackwoodsproductiondb4f7vq2"
					},
					"SourceID": {
						"type": "String",
						"defaultValue": "skmopt6atrldmbcplagqyg2kqa"
					},
					"BearerKey": {
						"type": "String",
						"defaultValue": "xx1b9103ee-5ac4-4917-a945-66f5b26def8b"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Delta Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/2 4 1 Delta_BPart_Add_Update')]",
				"[concat(variables('factoryId'), '/pipelines/4 Delta_Partial_CNT')]",
				"[concat(variables('factoryId'), '/pipelines/3 Delta_Partial_BOPS')]",
				"[concat(variables('factoryId'), '/pipelines/2 1 Delta_initial_load_Update')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/1 Push Data to Coveo - Main ADF Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "This is the pipeline to trigger first for Full load.",
				"activities": [
					{
						"name": "Step1-Load_CoveoPushData",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Load_CoveoPushData]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Step2-Json_WO_CSP_CNT_BOPS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Step1-Load_CoveoPushData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_WO_CSP_CNT]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Step2-Json_Bops_Partial",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Step2-Json_WO_CSP_CNT_BOPS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_Bops_Partial]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Initial Load Pipeline Call",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Step2-Json_WO_CSP_CNT_BOPS",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "3 BPart JSON Grouping",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Step1-Load_CoveoPushData_Availability",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "2 1 Initial Load - Coveo BWProducts Parallel_Chunks_v1_90",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('Organization id')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('Source id')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Wait 60min after Initial load",
						"description": "To prepare index at Coveo, Wait 60 minutes. This time depends on size of data pushing.",
						"type": "Wait",
						"dependsOn": [
							{
								"activity": "Initial Load Pipeline Call",
								"dependencyConditions": [
									"Succeeded",
									"Failed"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"waitTimeInSeconds": 5400
						}
					},
					{
						"name": "Step3-Json_Bops_Partial_MaxPayload",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Step2-Json_Bops_Partial",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[stg].[CoveoPushData_JSON_Bops_Max_Payload]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Bops data Push to Coveo",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "Wait 60min after Initial load",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Bops Lookup Table Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_Bops_partilal",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('Organization id')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('Source id')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Bops Lookup Table Preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Step3-Json_Bops_Partial_MaxPayload",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_Bops_lookup]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CNT JSON Preparation 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Script2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_CNT_Partial_1]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CNT JSON Maxpayload 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Preparation 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[stg].[CoveoPushData_JSON_cnt_Max_Payload_1]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP CNT Lookup 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Maxpayload 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_cnt_lookup1]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Script2",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Step2-Json_WO_CSP_CNT_BOPS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "truncate table stg.cnt_loaddistributor"
								}
							]
						}
					},
					{
						"name": "CNT JSON Preparation 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Script2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_CNT_Partial_2]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CNT JSON Maxpayload 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Preparation 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[stg].[CoveoPushData_JSON_cnt_Max_Payload_2]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP CNT Lookup 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Maxpayload 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_cnt_lookup2]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Partial Push CNT 2",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SP CNT Lookup 2",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Wait 60min after Initial load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partial_2",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('Organization id')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('Source id')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "CNT JSON Preparation 3",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Script2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_CNT_Partial_3]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CNT JSON Maxpayload 3",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Preparation 3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[stg].[CoveoPushData_JSON_cnt_Max_Payload_3]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP CNT Lookup 3",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Maxpayload 3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_cnt_lookup3]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Partial Push CNT 3",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SP CNT Lookup 3",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Wait 60min after Initial load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partial_3",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('Organization id')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('Source id')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "Partial Push CNT 1",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SP CNT Lookup 1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Wait 60min after Initial load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partial_1",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationId": {
									"value": "@variables('Organization id')",
									"type": "Expression"
								},
								"SourceID": {
									"value": "@variables('Source id')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "CNT JSON Preparation 4",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Script2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_CNT_Partial_4]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "CNT JSON Maxpayload 4",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Preparation 4",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[stg].[CoveoPushData_JSON_cnt_Max_Payload_4]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "SP CNT Lookup 4",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "CNT JSON Maxpayload 4",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_cnt_lookup4]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Partial Push CNT 4",
						"type": "ExecutePipeline",
						"dependsOn": [
							{
								"activity": "SP CNT Lookup 4",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Wait 60min after Initial load",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"pipeline": {
								"referenceName": "3 Coveo_CNT_partial_4",
								"type": "PipelineReference"
							},
							"waitOnCompletion": true,
							"parameters": {
								"OrganizationID": {
									"value": "@variables('Organization id')",
									"type": "Expression"
								},
								"SoruceID": {
									"value": "@variables('Source id')",
									"type": "Expression"
								},
								"BearerKey": {
									"value": "@variables('BearerKey')",
									"type": "Expression"
								}
							}
						}
					},
					{
						"name": "1 BPart Products Preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_BPart_Lookup]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "1 BPart JSON preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_BPart]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "2 BPart JSON MaxPayload Preparation",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "1 BPart JSON preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "1 BPart Products Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_JSON_BPart_Max_Payload]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "3 BPart JSON Grouping",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "2 BPart JSON MaxPayload Preparation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[CoveoPushData_Json_BPart_lookup_group]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Step1-Load_CoveoPushData_Availability",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Load_CoveoPushData_availability]"
						},
						"linkedServiceName": {
							"referenceName": "AzureSqlDatabase1",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Error Mail Notification",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Initial Load Pipeline Call",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-14.southeastasia.logic.azure.com:443/workflows/b5dccf7903484ee1b6c772c3a8aa0f51/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uhVEhHPsZNiltHdyvFv5ZGDfRXHequxZ6hM7Dvt0QIw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"value": "{\n    \"ADFName\":\"@{pipeline().DataFactory}\",\n    \"ErrorMessage\":\"@{activity('Initial Load Pipeline Call').Error.Message}\",\n    \"PipelineName\":\"@{pipeline().Pipeline}\"\n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Error Mail Notification_CNT1",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Partial Push CNT 1",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-14.southeastasia.logic.azure.com:443/workflows/b5dccf7903484ee1b6c772c3a8aa0f51/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uhVEhHPsZNiltHdyvFv5ZGDfRXHequxZ6hM7Dvt0QIw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"value": "{\n    \"ADFName\":\"@{pipeline().DataFactory}\",\n    \"ErrorMessage\":\"@{activity('Partial Push CNT 1').Error.Message}\",\n    \"PipelineName\":\"@{pipeline().Pipeline}\"\n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Error Mail Notification_CNT 2",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Partial Push CNT 2",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-14.southeastasia.logic.azure.com:443/workflows/b5dccf7903484ee1b6c772c3a8aa0f51/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uhVEhHPsZNiltHdyvFv5ZGDfRXHequxZ6hM7Dvt0QIw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"value": "{\n    \"ADFName\":\"@{pipeline().DataFactory}\",\n    \"ErrorMessage\":\"@{activity('Partial Push CNT 2').Error.Message}\",\n    \"PipelineName\":\"@{pipeline().Pipeline}\"\n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Error Mail Notification_CNT 3",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Partial Push CNT 3",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-14.southeastasia.logic.azure.com:443/workflows/b5dccf7903484ee1b6c772c3a8aa0f51/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uhVEhHPsZNiltHdyvFv5ZGDfRXHequxZ6hM7Dvt0QIw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"value": "{\n    \"ADFName\":\"@{pipeline().DataFactory}\",\n    \"ErrorMessage\":\"@{activity('Partial Push CNT 3').Error.Message}\",\n    \"PipelineName\":\"@{pipeline().Pipeline}\"\n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Error Mail Notification_CNT 4",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Partial Push CNT 4",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-14.southeastasia.logic.azure.com:443/workflows/b5dccf7903484ee1b6c772c3a8aa0f51/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uhVEhHPsZNiltHdyvFv5ZGDfRXHequxZ6hM7Dvt0QIw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"value": "{\n    \"ADFName\":\"@{pipeline().DataFactory}\",\n    \"ErrorMessage\":\"@{activity('Partial Push CNT 4').Error.Message}\",\n    \"PipelineName\":\"@{pipeline().Pipeline}\"\n}",
								"type": "Expression"
							}
						}
					},
					{
						"name": "Error Mail Notification_BOPS",
						"type": "WebActivity",
						"dependsOn": [
							{
								"activity": "Bops data Push to Coveo",
								"dependencyConditions": [
									"Failed"
								]
							}
						],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-14.southeastasia.logic.azure.com:443/workflows/b5dccf7903484ee1b6c772c3a8aa0f51/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uhVEhHPsZNiltHdyvFv5ZGDfRXHequxZ6hM7Dvt0QIw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"value": "{\n    \"ADFName\":\"@{pipeline().DataFactory}\",\n    \"ErrorMessage\":\"@{activity('Bops data Push to Coveo').Error.Message}\",\n    \"PipelineName\":\"@{pipeline().Pipeline}\"\n}",
								"type": "Expression"
							}
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"Organization id": {
						"type": "String",
						"defaultValue": "blackwoodsproductiondb4f7vq2"
					},
					"Source id": {
						"type": "String",
						"defaultValue": "skmopt6atrldmbcplagqyg2kqa"
					},
					"empty_body": {
						"type": "String",
						"defaultValue": "{}"
					},
					"BearerKey": {
						"type": "String",
						"defaultValue": "xx1b9103ee-5ac4-4917-a945-66f5b26def8b"
					}
				},
				"folder": {
					"name": "BlackOps to Coveo Full Load Pipelines"
				},
				"annotations": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/2 1 Initial Load - Coveo BWProducts Parallel_Chunks_v1_90')]",
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partial_2')]",
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partial_3')]",
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partial_1')]",
				"[concat(variables('factoryId'), '/pipelines/3 Coveo_CNT_partial_4')]"
			]
		}
	]
}